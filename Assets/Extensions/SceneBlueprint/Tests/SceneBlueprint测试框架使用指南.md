# SceneBlueprint æµ‹è¯•æ¡†æ¶ä½¿ç”¨æŒ‡å—

## ğŸ¯ ç°åœ¨ä½ å¯ä»¥åšä»€ä¹ˆ

### âœ… **ç«‹å³å¯ç”¨çš„åŠŸèƒ½**

#### **1. è¿è¡ŒçœŸæ­£çš„ NUnit æµ‹è¯•**
```
Unityèœå• â†’ SceneBlueprint â†’ Tests â†’ Open Unity Test Runner
```
- ä¼šè‡ªåŠ¨æ‰“å¼€ Unity Test Runner çª—å£
- åœ¨ EditMode æ ‡ç­¾é¡µæŸ¥çœ‹æ‰€æœ‰æµ‹è¯•
- ç‚¹å‡» "Run All" è¿è¡Œå®Œæ•´æµ‹è¯•å¥—ä»¶
- å³é”®å•ä¸ªæµ‹è¯•ç±»å¯å•ç‹¬è¿è¡Œ

#### **2. æµ‹è¯•å‘ç°å’Œåˆ†æ**
```
Unityèœå• â†’ SceneBlueprint â†’ Tests â†’ Test Discovery â†’ Discover All Tests
```
- ç»Ÿè®¡é¡¹ç›®ä¸­çš„æ‰€æœ‰æµ‹è¯•
- æ˜¾ç¤ºæµ‹è¯•ç±»å’Œæµ‹è¯•æ–¹æ³•æ•°é‡
- æä¾›æµ‹è¯•ä½ç½®å’Œç»“æ„ä¿¡æ¯

#### **3. è´¨é‡é—¨ç¦æ£€æŸ¥**
```
Unityèœå• â†’ SceneBlueprint â†’ Tests â†’ Quality Gate Check
```
- æ˜¾ç¤ºè´¨é‡æ£€æŸ¥æ¸…å•
- æä¾›å…·ä½“çš„æ£€æŸ¥æŒ‡å¯¼
- ç¡®ä¿ä»£ç è´¨é‡æ ‡å‡†

#### **4. ä»£ç è¦†ç›–ç‡åˆ†æ**
```
Unityèœå• â†’ SceneBlueprint â†’ Tests â†’ Code Coverage â†’ Analyze Coverage
```
- åˆ†æä»£ç è¦†ç›–ç‡
- è¯†åˆ«æœªæµ‹è¯•çš„ä»£ç åŒºåŸŸ
- ç”Ÿæˆè¯¦ç»†è¦†ç›–ç‡æŠ¥å‘Š

## ğŸ› ï¸ å¦‚ä½•ç¼–å†™æ–°æµ‹è¯•

### **ä½¿ç”¨æµ‹è¯•å·¥å…·ç±»**

```csharp
// 1. å¼•å…¥å¿…è¦çš„å‘½åç©ºé—´
using NUnit.Framework;
using SceneBlueprint.Core;
using SceneBlueprint.Tests.Utils;  // å·¥å…·ç±»

// 2. ä½¿ç”¨ TestDataBuilder åˆ›å»ºæµ‹è¯•æ•°æ®
[Test]
public void MyNewTest_Scenario_Expected()
{
    // Arrange - ä½¿ç”¨å·¥å…·ç±»åˆ›å»ºæ•°æ®
    var bag = TestDataBuilder.CreateEmptyPropertyBag();
    var registry = TestDataBuilder.CreateDiscoveredRegistry();
    
    // Act - æ‰§è¡Œæ“ä½œ
    bag.Set("testKey", "testValue");
    
    // Assert - ä½¿ç”¨æ‰©å±•æ–­è¨€
    bag.ShouldContainKey("testKey");
    bag.ShouldContain("testKey", "testValue");
}
```

### **Unity Editor èœå•åŠŸèƒ½**

é€šè¿‡ Unity èœå•æ å¯ä»¥å¿«é€Ÿè®¿é—®æ‰€æœ‰æµ‹è¯•åŠŸèƒ½ï¼š

```
SceneBlueprint â†’ Tests â†’ 
â”œâ”€â”€ ğŸš€ æ‰“å¼€ Unity Test Runner    # ä¸»è¦æµ‹è¯•åŠŸèƒ½
â”œâ”€â”€ ğŸ“Š æµ‹è¯•ç»Ÿè®¡ä¿¡æ¯             # æŸ¥çœ‹æµ‹è¯•æ•°é‡ç»Ÿè®¡
â”œâ”€â”€ ğŸ“‚ æŸ¥çœ‹æµ‹è¯•ç»“æ„             # æ˜¾ç¤ºç›®å½•ç»“æ„
â”œâ”€â”€ ğŸ¯ å¿«é€Ÿæµ‹è¯•æŒ‡å—             # ä½¿ç”¨æŒ‡å¯¼
â”œâ”€â”€ ğŸ”§ æµ‹è¯•å·¥å…·ç®±              # å·¥å…·ç±»ä»‹ç»
â”œâ”€â”€ ğŸ“Š ä»£ç è¦†ç›–ç‡åˆ†æ           # è¦†ç›–ç‡åˆ†æ
â”œâ”€â”€ ğŸ“ æ‰“å¼€æµ‹è¯•ç›®å½•             # ç›´æ¥æ‰“å¼€æ–‡ä»¶å¤¹
â””â”€â”€ ğŸ“– æ‰“å¼€ä½¿ç”¨æŒ‡å—             # æ‰“å¼€æ­¤æ–‡æ¡£
```

### **æµ‹è¯•æ•°æ®æ„å»ºå™¨ API**

```csharp
// åŸºç¡€æ•°æ®åˆ›å»º
TestDataBuilder.CreateEmptyPropertyBag()
TestDataBuilder.CreatePropertyBag(("key", "value"), ("count", 42))
TestDataBuilder.CreateDiscoveredRegistry()

// å¤æ‚åœºæ™¯æ•°æ®  
TestDataBuilder.CreateSpawnNodeData()
TestDataBuilder.CreateFullFlowTestData()

// è¾¹ç•Œå’Œæ€§èƒ½æµ‹è¯•æ•°æ®
TestDataBuilder.CreateLargePropertyBag(1000)
TestDataBuilder.CreateBoundaryValuePropertyBag()
```

### **æ‰©å±•æ–­è¨€ API**

```csharp
// PropertyBag æ–­è¨€
bag.ShouldContainKey("key")
bag.ShouldContain("key", "expectedValue")
bag.ShouldHaveCount(5)
bag.ShouldBeEmpty()

// ActionDefinition æ–­è¨€
def.ShouldHaveBasicFields("TypeId", "DisplayName", "Category")
def.ShouldHavePort("in", PortDirection.In)
def.ShouldHaveProperty("template", PropertyType.AssetRef)

// æ€§èƒ½æ–­è¨€
action.ShouldCompleteWithin(1000)  // 1ç§’å†…å®Œæˆ

// åºåˆ—åŒ–æ–­è¨€
bag.ShouldSerializeCorrectly()  // JSONå¾€è¿”æ­£ç¡®
```

## ğŸ“ æµ‹è¯•æ–‡ä»¶ç»„ç»‡

### **å½“å‰æµ‹è¯•ç»“æ„**
```
Tests/
â”œâ”€â”€ Unit/Core/              # å•å…ƒæµ‹è¯• (8ä¸ªæ–‡ä»¶)
â”‚   â”œâ”€â”€ ActionDefinitionTests.cs
â”‚   â”œâ”€â”€ PropertyBagTests.cs  
â”‚   â”œâ”€â”€ ActionRegistryTests.cs
â”‚   â”œâ”€â”€ PropFactoryTests.cs
â”‚   â”œâ”€â”€ VisibleWhenTests.cs
â”‚   â””â”€â”€ PropertyBagTests_Example.cs  # æœ€ä½³å®è·µç¤ºä¾‹
â”œâ”€â”€ Integration/            # é›†æˆæµ‹è¯• (2ä¸ªæ–‡ä»¶)
â”‚   â”œâ”€â”€ FlowActionTests.cs
â”‚   â””â”€â”€ CombatActionTests.cs
â”œâ”€â”€ E2E/                   # ç«¯åˆ°ç«¯æµ‹è¯• (1ä¸ªæ–‡ä»¶)
â”‚   â””â”€â”€ EndToEndTests.cs
â””â”€â”€ Unit/Utils/            # å·¥å…·ç±»
    â”œâ”€â”€ TestDataBuilder.cs
    â””â”€â”€ AssertionExtensions.cs
```

### **æ·»åŠ æ–°æµ‹è¯•æ–‡ä»¶**
1. **å•å…ƒæµ‹è¯•** â†’ `Tests/Unit/Core/{ClassName}Tests.cs`
2. **é›†æˆæµ‹è¯•** â†’ `Tests/Integration/{Feature}Tests.cs`  
3. **E2Eæµ‹è¯•** â†’ `Tests/E2E/{Scenario}E2ETests.cs`

## ğŸš€ TDD å¼€å‘å·¥ä½œæµ

### **æ¨èæµç¨‹**
1. **ç¼–å†™å¤±è´¥æµ‹è¯•** â†’ æè¿°é¢„æœŸè¡Œä¸º
2. **å®ç°æœ€å°åŠŸèƒ½** â†’ è®©æµ‹è¯•é€šè¿‡
3. **è¿è¡Œæµ‹è¯•éªŒè¯** â†’ Unity Test Runner ä¸­æ£€æŸ¥
4. **é‡æ„ä¼˜åŒ–** â†’ ä¿æŒæµ‹è¯•é€šè¿‡
5. **å®Œæ•´æµ‹è¯•** â†’ è¿è¡Œæ‰€æœ‰æµ‹è¯•ç¡®ä¿æ— ç ´å

### **æ—¥å¸¸å¼€å‘å»ºè®®**
```
å¼€å‘æ–°åŠŸèƒ½æ—¶ï¼š
1. æ‰“å¼€ Unity Test Runner (Window â†’ General â†’ Test Runner)
2. ç¼–å†™æµ‹è¯•æè¿°æœŸæœ›çš„è¡Œä¸º
3. è¿è¡Œæµ‹è¯•ç¡®è®¤å¤±è´¥ï¼ˆçº¢è‰²ï¼‰
4. å®ç°åŠŸèƒ½ç›´åˆ°æµ‹è¯•é€šè¿‡ï¼ˆç»¿è‰²ï¼‰
5. é‡æ„ä»£ç ä¿æŒæµ‹è¯•é€šè¿‡
6. è¿è¡Œå®Œæ•´æµ‹è¯•å¥—ä»¶ç¡®è®¤æ— å›å½’
```

## ğŸ¨ æµ‹è¯•æ¡†æ¶ç‰¹è‰²åŠŸèƒ½

### **1. Unity Editor æ·±åº¦é›†æˆ**
- ä¾¿æ·çš„èœå•è®¿é—® (`SceneBlueprint â†’ Tests`)
- ä¸€é”®æ‰“å¼€ Unity Test Runner
- ä¸°å¯Œçš„æ§åˆ¶å°æ—¥å¿—è¾“å‡º
- å®æ—¶æµ‹è¯•ç»Ÿè®¡å’Œç»“æ„æŸ¥çœ‹

### **2. é«˜æ•ˆæµ‹è¯•å·¥å…·**
- `TestDataBuilder` - å¿«é€Ÿåˆ›å»ºæµ‹è¯•æ•°æ®
- `AssertionExtensions` - è¡¨è¾¾æ€§æ–­è¨€æ–¹æ³•
- `CoverageAnalyzer` - ä»£ç è¦†ç›–ç‡åˆ†æ
- ä¸“é—¨é’ˆå¯¹ SceneBlueprint å¯¹è±¡çš„æ–­è¨€

### **3. å¼€å‘ä½“éªŒä¼˜åŒ–**
- æ¸…æ™°çš„æµ‹è¯•ç›®å½•ç»“æ„
- è¯¦ç»†çš„ä½¿ç”¨æŒ‡å—å’ŒFAQ
- æœ€ä½³å®è·µç¤ºä¾‹æ–‡ä»¶
- å‹å¥½çš„é”™è¯¯æ¶ˆæ¯å’Œè°ƒè¯•æ”¯æŒ

### **4. å®ç”¨å·¥å…·é›†æˆ**
- æµ‹è¯•ç›®å½•å¿«é€Ÿè®¿é—®
- æ–‡æ¡£ä¸€é”®æ‰“å¼€
- æµ‹è¯•ç»“æ„å¯è§†åŒ–
- ç¤ºä¾‹ä»£ç ç”Ÿæˆ

## ğŸ’¡ å¼€å‘æœ€ä½³å®è·µ

### **æµ‹è¯•ç¼–å†™å»ºè®®**
- **ä¼˜å…ˆç¼–å†™å•å…ƒæµ‹è¯•** - å¿«é€Ÿåé¦ˆï¼Œæ˜“äºç»´æŠ¤
- **é€‚é‡é›†æˆæµ‹è¯•** - éªŒè¯ç»„ä»¶åä½œ
- **å…³é”®åŠŸèƒ½è¦†ç›–** - ç¡®ä¿æ ¸å¿ƒåŠŸèƒ½è´¨é‡
- **ä½¿ç”¨å·¥å…·ç±»** - æé«˜ç¼–å†™æ•ˆç‡

### **å‘½åè§„èŒƒ**
- æµ‹è¯•ç±»ï¼š`{ClassName}Tests`
- æµ‹è¯•æ–¹æ³•ï¼š`Method_Scenario_Expected`
- æµ‹è¯•æ–‡ä»¶ï¼šæ”¾åœ¨å¯¹åº”çš„æµ‹è¯•ç›®å½•ä¸­

### **è´¨é‡è¦æ±‚**
- æ‰€æœ‰æµ‹è¯•å¿…é¡»é€šè¿‡
- æ–°ä»£ç è¦æœ‰å¯¹åº”æµ‹è¯•
- æ— ç¼–è¯‘è­¦å‘Šæˆ–é”™è¯¯
- ä¿æŒæµ‹è¯•ä»£ç ç®€æ´æ¸…æ™°

## ğŸ” å¸¸è§é—®é¢˜è§£å†³

### **Q: æµ‹è¯•æ²¡æœ‰åœ¨ Test Runner ä¸­æ˜¾ç¤ºï¼Ÿ**
A: æ£€æŸ¥ï¼š
- æµ‹è¯•ç±»åæ˜¯å¦ä»¥ `Tests` ç»“å°¾
- æµ‹è¯•æ–¹æ³•æ˜¯å¦æ ‡è®°äº† `[Test]` å±æ€§
- å‘½åç©ºé—´æ˜¯å¦æ­£ç¡®
- é¡¹ç›®æ˜¯å¦ç¼–è¯‘æˆåŠŸ

### **Q: å¦‚ä½•è¿è¡Œç‰¹å®šçš„æµ‹è¯•ï¼Ÿ**
A: åœ¨ Unity Test Runner ä¸­ï¼š
- å³é”®æµ‹è¯•ç±» â†’ "Run"
- æˆ–ç‚¹å‡»å•ä¸ªæµ‹è¯•æ–¹æ³•çš„ "Run" æŒ‰é’®

### **Q: å¦‚ä½•è°ƒè¯•æµ‹è¯•ï¼Ÿ**
A: 
- åœ¨æµ‹è¯•ä»£ç ä¸­è®¾ç½®æ–­ç‚¹
- åœ¨ Test Runner ä¸­å³é”®æµ‹è¯• â†’ "Debug"
- ä½¿ç”¨ `Debug.Log()` è¾“å‡ºè°ƒè¯•ä¿¡æ¯

### **Q: æµ‹è¯•å·¥å…·ç±»æ‰¾ä¸åˆ°ï¼Ÿ**
A: ç¡®ä¿å¼•å…¥äº†å‘½åç©ºé—´ï¼š
```csharp
using SceneBlueprint.Tests.Utils;
```

## ğŸ“ˆ åç»­æ‰©å±•

### **å¯ä»¥æ·»åŠ çš„åŠŸèƒ½**
1. **Mock å¯¹è±¡æ”¯æŒ** - ç”¨äºéš”ç¦»æµ‹è¯•
2. **å‚æ•°åŒ–æµ‹è¯•** - ç”¨ `[TestCase]` å±æ€§
3. **æ€§èƒ½åŸºå‡†æµ‹è¯•** - ä¸“é—¨çš„æ€§èƒ½æµ‹è¯•ç±»
4. **UI æµ‹è¯•** - é’ˆå¯¹ç¼–è¾‘å™¨ UI çš„æµ‹è¯•
5. **é›†æˆ CI/CD** - ä½¿ç”¨å·²æœ‰çš„ GitHub Actions é…ç½®

### **æµ‹è¯•ç­–ç•¥å»ºè®®**
- **ä¼˜å…ˆç¼–å†™å•å…ƒæµ‹è¯•** - å¿«é€Ÿåé¦ˆï¼Œæ˜“äºç»´æŠ¤
- **é€‚é‡é›†æˆæµ‹è¯•** - éªŒè¯ç»„ä»¶åä½œ
- **å…³é”® E2E æµ‹è¯•** - è¦†ç›–ä¸»è¦ç”¨æˆ·åœºæ™¯
- **å®šæœŸé‡æ„æµ‹è¯•** - ä¿æŒæµ‹è¯•ä»£ç è´¨é‡

---

## ğŸ‰ å¼€å§‹ä½¿ç”¨

1. **ç«‹å³å°è¯•**ï¼š`Unity â†’ SceneBlueprint â†’ Tests â†’ Open Unity Test Runner`
2. **æŸ¥çœ‹ç¤ºä¾‹**ï¼š`Tests/Unit/Core/PropertyBagTests_Example.cs`
3. **ç¼–å†™ç¬¬ä¸€ä¸ªæµ‹è¯•**ï¼šä½¿ç”¨å·¥å…·ç±»å’Œæ‰©å±•æ–­è¨€
4. **å»ºç«‹ TDD ä¹ æƒ¯**ï¼šçº¢â†’ç»¿â†’é‡æ„çš„å¼€å‘å¾ªç¯

**æµ‹è¯•æ¡†æ¶å·²å®Œå…¨å°±ç»ªï¼Œç¥ä½ å¼€å‘æ„‰å¿«ï¼** ğŸš€
