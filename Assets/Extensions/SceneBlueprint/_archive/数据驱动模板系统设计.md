# æ•°æ®é©±åŠ¨æ¨¡æ¿ç³»ç»Ÿè®¾è®¡

> ç‰ˆæœ¬ï¼šv0.1ï¼ˆè‰æ¡ˆï¼‰  
> æ—¥æœŸï¼š2026-02-14  
> çŠ¶æ€ï¼šè®¾è®¡é˜¶æ®µï¼ˆè‰æ¡ˆï¼Œéƒ¨åˆ†å†…å®¹å·²è¿‡æ—¶ï¼‰  
> çˆ¶æ–‡æ¡£ï¼š[åœºæ™¯è“å›¾ç³»ç»Ÿæ€»ä½“è®¾è®¡](../åœºæ™¯è“å›¾ç³»ç»Ÿæ€»ä½“è®¾è®¡.md)  
> å…³è”ï¼š[Actionä¸å±æ€§ç³»ç»Ÿè®¾è®¡](../Actionä¸å±æ€§ç³»ç»Ÿè®¾è®¡.md)ã€[SceneMarkerç³»ç»Ÿè®¾è®¡](../SceneMarkerç³»ç»Ÿè®¾è®¡.md)
> doc_status: deprecated  
> last_reviewed: 2026-02-15

---

## 1. æ¦‚è¿°

### 1.1 é—®é¢˜èƒŒæ™¯

å½“å‰ SceneBlueprint æ¡†æ¶çš„æ‰€æœ‰æ‰©å±•ç‚¹ï¼ˆAction ç±»å‹ã€Marker ç±»å‹ã€Gizmo æ ·å¼ç­‰ï¼‰éƒ½å¿…é¡»é€šè¿‡ C# ä»£ç å®šä¹‰ã€‚è¿™æ„å‘³ç€ï¼š

- **ç­–åˆ’æ— æ³•ç‹¬ç«‹æ‰©å±•**ï¼šæ–°å¢ä¸€ç§ Action ç±»å‹å¿…é¡»ç¨‹åºå‘˜å†™ C# + ç­‰ç¼–è¯‘
- **é…ç½®ä¸é€»è¾‘è€¦åˆ**ï¼šèŠ‚ç‚¹"é•¿ä»€ä¹ˆæ ·"å’Œ"è¿è¡Œæ—¶åšä»€ä¹ˆ"æ··åœ¨åŒä¸€ä¸ª C# ç±»ä¸­
- **è°ƒå‚éœ€è¦ç¼–è¯‘**ï¼šä¿®æ”¹ Gizmo é¢œè‰²ã€æ ‡è®°é—´è·ç­‰è§†è§‰å‚æ•°ä¹Ÿéœ€è¦æ”¹ä»£ç 

### 1.2 è®¾è®¡ç›®æ ‡

å¼•å…¥ **ScriptableObject æ•°æ®é©±åŠ¨å±‚**ï¼Œè®©ç­–åˆ’èƒ½åœ¨ Unity Inspector ä¸­"å¡«è¡¨"å®Œæˆä»¥ä¸‹æ“ä½œï¼š

1. **å®šä¹‰æ–°çš„ Action èŠ‚ç‚¹ç±»å‹**ï¼ˆå±æ€§ã€ç«¯å£ã€åœºæ™¯éœ€æ±‚ã€åˆ†ç±»é¢œè‰²ï¼‰
2. **ä¿å­˜å’Œå¤ç”¨å­è“å›¾æ¨¡æ¿**ï¼ˆå¸¸ç”¨è¡Œä¸ºæ¨¡å¼å°è£…ï¼‰
3. **è°ƒæ•´ Gizmo è§†è§‰å‚æ•°**ï¼ˆé¢œè‰²ã€é€æ˜åº¦ã€å°ºå¯¸ï¼Œæ— éœ€ç¼–è¯‘ï¼‰
4. **åˆ›å»º Marker é¢„è®¾**ï¼ˆå·²æœ‰æ ‡è®°ç±»å‹çš„å˜ä½“é…ç½®ï¼‰
5. **ç®¡ç†èŠ‚ç‚¹åˆ†ç±»ä½“ç³»**ï¼ˆåˆ†ç±»åã€é¢œè‰²ã€æ’åºï¼‰

### 1.3 æ ¸å¿ƒåŸåˆ™

- **æ¸è¿›å¼å¼•å…¥**ï¼šä¸ç ´åç°æœ‰ C# æ‰©å±•æ–¹å¼ï¼ŒSO æ¨¡æ¿ä½œä¸ºè¡¥å……æ•°æ®æº
- **é›¶å¤–éƒ¨ä¾èµ–**ï¼šçº¯ Unity åŸç”Ÿ ScriptableObjectï¼Œä¸å¼•å…¥è„šæœ¬å¼•æ“
- **C# ä¼˜å…ˆåˆå¹¶**ï¼šå½“ C# å®šä¹‰ä¸ SO æ¨¡æ¿ TypeId å†²çªæ—¶ï¼ŒC# ä¼˜å…ˆ
- **èŒè´£åˆ†ç¦»**ï¼šç­–åˆ’ç®¡"æ˜¯ä»€ä¹ˆ"ï¼ˆå®šä¹‰ï¼‰ï¼Œç¨‹åºç®¡"æ€ä¹ˆåš"ï¼ˆè¿è¡Œæ—¶è¡Œä¸ºï¼‰

### 1.4 æ¶æ„æ€»è§ˆ

```
               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
               â”‚     Registry      â”‚  â† ç»Ÿä¸€æ³¨å†Œè¡¨ï¼ˆåˆå¹¶ä¸¤ç§æ¥æºï¼‰
               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚ åˆå¹¶
               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
               â–¼                   â–¼
      C# Definition          SO Template
      (ç¨‹åºå®šä¹‰,ä¼˜å…ˆ)        (ç­–åˆ’é…ç½®,è¡¥å……)
      
  ActionRegistry  â† IActionDefinitionProvider (C#) + ActionTemplateSO
  MarkerRegistry  â† IMarkerDefinitionProvider (C#) + MarkerPresetSO
  TemplateLibrary â† BlueprintTemplateSO (çº¯ç­–åˆ’)
  StyleLibrary    â† GizmoStyleConstants (C#é»˜è®¤) + GizmoStyleSO (è¦†ç›–)
  CategoryLibrary â† å†…ç½®åˆ†ç±» (C#) + CategorySO (ç­–åˆ’æ‰©å±•)
```

---

## 2. Phase Aï¼šæ ¸å¿ƒæ¨¡æ¿ï¼ˆé«˜ä¼˜å…ˆçº§ï¼‰

### 2.1 ActionTemplateSO â€” ç­–åˆ’å®šä¹‰æ–° Action ç±»å‹

#### 2.1.1 åŠ¨æœº

å½“å‰å®šä¹‰ä¸€ä¸ªæ–° Action ç±»å‹éœ€è¦å†™ C#ï¼š

```csharp
// å½“å‰æ–¹å¼ï¼šå¿…é¡»å†™ C# æ–‡ä»¶
[ActionType("Combat.Spawn")]
public class SpawnActionDef : IActionDefinitionProvider
{
    public ActionDefinition Define() => new ActionDefinition
    {
        TypeId = "Combat.Spawn",
        DisplayName = "åˆ·æ€ª",
        Category = "Combat",
        ThemeColor = new Color(0.2f, 0.7f, 0.3f),
        // ... å±æ€§ã€ç«¯å£ã€åœºæ™¯éœ€æ±‚
    };
}
```

ç­–åˆ’æƒ³æ–°å¢ä¸€ä¸ª"æ’­æ”¾æ—¶é—´çº¿"èŠ‚ç‚¹ï¼Œå¿…é¡»æ‰¾ç¨‹åºå‘˜ã€‚ä½†å®é™…ä¸Šï¼Œè¿™ä¸ªèŠ‚ç‚¹çš„**å…ƒæ•°æ®**ï¼ˆæœ‰å“ªäº›å±æ€§ã€éœ€è¦ä»€ä¹ˆæ ‡è®°ã€å±äºä»€ä¹ˆåˆ†ç±»ï¼‰å®Œå…¨å¯ä»¥ç”¨æ•°æ®æè¿°ã€‚

#### 2.1.2 æ•°æ®ç»“æ„

```csharp
/// <summary>
/// ç­–åˆ’é€šè¿‡ Inspector é…ç½®çš„ Action ç±»å‹æ¨¡æ¿ã€‚
/// ä¸ C# IActionDefinitionProvider ç­‰ä»·ï¼Œä½†æ— éœ€ç¼–å†™ä»£ç ã€‚
/// </summary>
[CreateAssetMenu(
    fileName = "NewActionTemplate",
    menuName = "SceneBlueprint/Action Template",
    order = 100)]
public class ActionTemplateSO : ScriptableObject
{
    [Header("â”€â”€ å…ƒæ•°æ® â”€â”€")]
    [Tooltip("å…¨å±€å”¯ä¸€ç±»å‹ IDï¼Œå¦‚ 'Cinematic.PlayTimeline'")]
    public string TypeId;

    [Tooltip("ç¼–è¾‘å™¨ä¸­æ˜¾ç¤ºçš„åç§°")]
    public string DisplayName;

    [Tooltip("åˆ†ç±»ï¼Œç”¨äºå³é”®èœå•å’Œæœç´¢çª—åˆ†ç»„")]
    public string Category;

    [Tooltip("èŠ‚ç‚¹ä¸»é¢˜è‰²")]
    public Color ThemeColor = Color.gray;

    [Tooltip("å›¾æ ‡æ ‡è¯†ï¼ˆå¯é€‰ï¼‰")]
    public string Icon;

    [TextArea(2, 4)]
    [Tooltip("æè¿°æ–‡æœ¬ï¼Œæ‚¬åœèŠ‚ç‚¹æ—¶æ˜¾ç¤º")]
    public string Description;

    [Tooltip("è¡ŒåŠ¨æ—¶é•¿ç±»å‹")]
    public ActionDuration Duration = ActionDuration.Instant;

    [Header("â”€â”€ ç«¯å£ â”€â”€")]
    [Tooltip("è¾“å‡ºç«¯å£åˆ—è¡¨ï¼ˆè¾“å…¥ç«¯å£é»˜è®¤æœ‰ä¸€ä¸ª'æ¿€æ´»'ï¼‰")]
    public List<PortEntry> OutputPorts = new()
    {
        new PortEntry { Id = "out", DisplayName = "å®Œæˆ" }
    };

    [Header("â”€â”€ å±æ€§ â”€â”€")]
    public List<PropertyEntry> Properties = new();

    [Header("â”€â”€ åœºæ™¯éœ€æ±‚ â”€â”€")]
    public List<SceneRequirementEntry> SceneRequirements = new();

    // â”€â”€â”€ åºåˆ—åŒ–ç”¨çš„åµŒå¥—ç»“æ„ â”€â”€â”€

    [Serializable]
    public class PortEntry
    {
        public string Id;
        public string DisplayName;
        [Tooltip("æ˜¯å¦å…è®¸å¤šæ¡è¿çº¿")]
        public bool AllowMultiple;
    }

    [Serializable]
    public class PropertyEntry
    {
        public string Key;
        public string DisplayName;
        public PropertyType Type;
        public string DefaultValue;        // ç»Ÿä¸€ç”¨å­—ç¬¦ä¸²ï¼Œè¿è¡Œæ—¶è§£æ
        [Tooltip("æ•°å€¼æœ€å°å€¼")]
        public float Min;
        [Tooltip("æ•°å€¼æœ€å¤§å€¼")]
        public float Max = 100f;
        [Tooltip("æšä¸¾é€‰é¡¹ï¼Œé€—å·åˆ†éš”")]
        public string EnumOptions;         // "Interval,Instant,Manual"
        [Tooltip("åœºæ™¯ç»‘å®šç±»å‹")]
        public BindingType BindingType;
        [Tooltip("èµ„äº§ç±»å‹è¿‡æ»¤ï¼ˆå®Œæ•´ç±»åï¼‰")]
        public string AssetFilterType;
        [Tooltip("æ¡ä»¶å¯è§æ€§è¡¨è¾¾å¼")]
        public string VisibleWhen;
        [Tooltip("Inspector åˆ†ç»„å")]
        public string Category;
        [Tooltip("æ’åˆ—é¡ºåº")]
        public int Order;
        [Tooltip("æ‚¬åœæç¤º")]
        public string Tooltip;
    }

    [Serializable]
    public class SceneRequirementEntry
    {
        public string BindingKey;
        public string MarkerTypeId;        // å¦‚ "Point", "Area", "Entity"
        public string DisplayName;
        public bool Required = true;
        public bool AllowMultiple;
        public string DefaultTag;
    }
}
```

#### 2.1.3 Inspector ä½“éªŒ

ç­–åˆ’åœ¨ Project çª—å£ä¸­ï¼š`Create â†’ SceneBlueprint â†’ Action Template`

```
â”Œâ”€ PlayTimelineTemplate (ActionTemplateSO) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                      â”‚
â”‚ â”€â”€ å…ƒæ•°æ® â”€â”€                                         â”‚
â”‚ TypeId:        [Cinematic.PlayTimeline     ]         â”‚
â”‚ DisplayName:   [æ’­æ”¾æ—¶é—´çº¿                  ]         â”‚
â”‚ Category:      [Cinematic                  ]         â”‚
â”‚ ThemeColor:    [â–  ç´«è‰²                     ]         â”‚
â”‚ Duration:      [Duration â–¼                 ]         â”‚
â”‚ Description:   [æ’­æ”¾ Timeline èµ„äº§ï¼Œæ”¯æŒ    ]         â”‚
â”‚                [é€Ÿåº¦æ§åˆ¶å’Œç›®æ ‡è·Ÿéš           ]         â”‚
â”‚                                                      â”‚
â”‚ â”€â”€ ç«¯å£ â”€â”€                                           â”‚
â”‚ OutputPorts:                                         â”‚
â”‚   [0] Id: out          DisplayName: å®Œæˆ             â”‚
â”‚   [1] Id: onInterrupt  DisplayName: è¢«ä¸­æ–­           â”‚
â”‚   [+ æ·»åŠ ]                                           â”‚
â”‚                                                      â”‚
â”‚ â”€â”€ å±æ€§ â”€â”€                                           â”‚
â”‚ Properties:                                          â”‚
â”‚   [0] Key: timelineAsset                             â”‚
â”‚       DisplayName: æ—¶é—´çº¿èµ„äº§                         â”‚
â”‚       Type: [AssetRef â–¼]                             â”‚
â”‚       AssetFilterType: UnityEngine.Timeline...       â”‚
â”‚                                                      â”‚
â”‚   [1] Key: playSpeed                                 â”‚
â”‚       DisplayName: æ’­æ”¾é€Ÿåº¦                           â”‚
â”‚       Type: [Float â–¼]                                â”‚
â”‚       DefaultValue: 1.0                              â”‚
â”‚       Min: 0.1  Max: 5.0                             â”‚
â”‚                                                      â”‚
â”‚   [2] Key: target                                    â”‚
â”‚       DisplayName: è·Ÿéšç›®æ ‡                           â”‚
â”‚       Type: [SceneBinding â–¼]                         â”‚
â”‚       BindingType: [Transform â–¼]                     â”‚
â”‚       VisibleWhen: playSpeed > 0                     â”‚
â”‚   [+ æ·»åŠ ]                                           â”‚
â”‚                                                      â”‚
â”‚ â”€â”€ åœºæ™¯éœ€æ±‚ â”€â”€                                       â”‚
â”‚ SceneRequirements:                                   â”‚
â”‚   [0] BindingKey: target                             â”‚
â”‚       MarkerTypeId: Point                            â”‚
â”‚       DisplayName: è·Ÿéšç›®æ ‡                           â”‚
â”‚       Required: âœ…                                    â”‚
â”‚   [+ æ·»åŠ ]                                           â”‚
â”‚                                                      â”‚
â”‚              [ğŸ” é¢„è§ˆèŠ‚ç‚¹å¤–è§‚]                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 2.1.4 è½¬æ¢ä¸º ActionDefinition

```csharp
/// <summary>
/// å°† ActionTemplateSO è½¬æ¢ä¸ºæ¡†æ¶å¯æ¶ˆè´¹çš„ ActionDefinitionã€‚
/// </summary>
public static class ActionTemplateConverter
{
    public static ActionDefinition Convert(ActionTemplateSO template)
    {
        var def = new ActionDefinition
        {
            TypeId = template.TypeId,
            DisplayName = template.DisplayName,
            Category = template.Category,
            Description = template.Description,
            ThemeColor = template.ThemeColor,
            Icon = template.Icon,
            Duration = template.Duration,
        };

        // ç«¯å£ï¼šé»˜è®¤ FlowIn + ç”¨æˆ·é…ç½®çš„è¾“å‡ºç«¯å£
        var ports = new List<PortDefinition>
        {
            Port.FlowIn("in", "æ¿€æ´»")
        };
        foreach (var p in template.OutputPorts)
        {
            ports.Add(new PortDefinition
            {
                Id = p.Id,
                DisplayName = p.DisplayName,
                Direction = PortDirection.Out,
                Capacity = p.AllowMultiple ? PortCapacity.Multiple : PortCapacity.Single
            });
        }
        def.Ports = ports.ToArray();

        // å±æ€§
        def.Properties = template.Properties
            .Select(p => ConvertProperty(p))
            .ToArray();

        // åœºæ™¯éœ€æ±‚
        def.SceneRequirements = template.SceneRequirements
            .Select(r => new MarkerRequirement
            {
                BindingKey = r.BindingKey,
                MarkerTypeId = r.MarkerTypeId,
                DisplayName = r.DisplayName,
                Required = r.Required,
                AllowMultiple = r.AllowMultiple,
                DefaultTag = r.DefaultTag
            })
            .ToArray();

        return def;
    }

    private static PropertyDefinition ConvertProperty(ActionTemplateSO.PropertyEntry p)
    {
        var prop = new PropertyDefinition
        {
            Key = p.Key,
            DisplayName = p.DisplayName,
            Type = p.Type,
            Tooltip = p.Tooltip,
            Category = p.Category,
            Order = p.Order,
            VisibleWhen = p.VisibleWhen,
        };

        // è§£æé»˜è®¤å€¼
        prop.DefaultValue = ParseDefaultValue(p.Type, p.DefaultValue);

        // ç±»å‹ç‰¹æœ‰å­—æ®µ
        switch (p.Type)
        {
            case PropertyType.Float:
            case PropertyType.Int:
                prop.Min = p.Min;
                prop.Max = p.Max;
                break;
            case PropertyType.Enum:
                prop.EnumOptions = p.EnumOptions?.Split(',')
                    .Select(s => s.Trim()).ToArray();
                break;
            case PropertyType.SceneBinding:
                prop.SceneBindingType = p.BindingType;
                break;
            case PropertyType.AssetRef:
                if (!string.IsNullOrEmpty(p.AssetFilterType))
                    prop.AssetFilter = Type.GetType(p.AssetFilterType);
                break;
        }

        return prop;
    }

    private static object ParseDefaultValue(PropertyType type, string raw)
    {
        if (string.IsNullOrEmpty(raw)) return null;
        return type switch
        {
            PropertyType.Float => float.TryParse(raw, out var f) ? f : 0f,
            PropertyType.Int => int.TryParse(raw, out var i) ? i : 0,
            PropertyType.Bool => raw.ToLower() == "true",
            PropertyType.String => raw,
            PropertyType.Enum => raw,
            _ => null
        };
    }
}
```

#### 2.1.5 Registry é›†æˆ

```csharp
/// <summary>
/// ActionRegistry.AutoDiscover æ‰©å±•ï¼šåˆå¹¶ C# å’Œ SO ä¸¤ç§æ¥æºã€‚
/// </summary>
public void AutoDiscover()
{
    // â”€â”€ Step 1: C# Providerï¼ˆä¼˜å…ˆï¼‰ â”€â”€
    var providerType = typeof(IActionDefinitionProvider);
    foreach (var assembly in AppDomain.CurrentDomain.GetAssemblies())
    {
        foreach (var type in assembly.GetTypes())
        {
            if (providerType.IsAssignableFrom(type) && !type.IsAbstract)
            {
                var attr = type.GetCustomAttribute<ActionTypeAttribute>();
                if (attr != null)
                {
                    var provider = (IActionDefinitionProvider)Activator.CreateInstance(type);
                    Register(provider.Define());
                }
            }
        }
    }

    // â”€â”€ Step 2: SO Templateï¼ˆè¡¥å……ï¼Œä¸è¦†ç›– C#ï¼‰ â”€â”€
    var guids = AssetDatabase.FindAssets("t:ActionTemplateSO");
    foreach (var guid in guids)
    {
        var path = AssetDatabase.GUIDToAssetPath(guid);
        var template = AssetDatabase.LoadAssetAtPath<ActionTemplateSO>(path);
        if (template == null || string.IsNullOrEmpty(template.TypeId)) continue;

        // C# å·²æ³¨å†Œçš„ TypeId ä¸è¢« SO è¦†ç›–
        if (TryGet(template.TypeId, out _))
        {
            SBLog.Warning(SBLogTags.Registry,
                $"ActionTemplateSO '{template.name}' çš„ TypeId '{template.TypeId}' " +
                $"ä¸ C# å®šä¹‰å†²çªï¼Œå·²è·³è¿‡");
            continue;
        }

        var def = ActionTemplateConverter.Convert(template);
        def.Source = ActionDefinitionSource.Template; // æ ‡è®°æ¥æº
        Register(def);
    }

    SBLog.Info(SBLogTags.Registry,
        $"ActionRegistry åŠ è½½å®Œæˆï¼š{GetAll().Count} ä¸ªå®šä¹‰ " +
        $"(C#: {GetAll().Count(d => d.Source == ActionDefinitionSource.Code)}, " +
        $"SO: {GetAll().Count(d => d.Source == ActionDefinitionSource.Template)})");
}

/// <summary>æ ‡è®° ActionDefinition çš„æ¥æºï¼Œä¾¿äºè°ƒè¯•å’Œå†²çªå¤„ç†ã€‚</summary>
public enum ActionDefinitionSource
{
    Code,       // C# IActionDefinitionProvider
    Template    // ActionTemplateSO
}
```

#### 2.1.6 éªŒè¯è§„åˆ™

ActionTemplateSO çš„è‡ªå®šä¹‰ Inspector åº”åœ¨ä¿å­˜æ—¶è¿›è¡ŒéªŒè¯ï¼š

```
éªŒè¯è§„åˆ™ï¼š
  âŒ TypeId ä¸ºç©º â†’ Error: "TypeId ä¸èƒ½ä¸ºç©º"
  âŒ TypeId æ ¼å¼é”™è¯¯ï¼ˆä¸å« '.'ï¼‰ â†’ Warning: "å»ºè®®ä½¿ç”¨ 'Category.Name' æ ¼å¼"
  âŒ TypeId ä¸å·²æœ‰ C# å®šä¹‰å†²çª â†’ Error: "ä¸ C# å®šä¹‰å†²çªï¼Œå°†è¢«å¿½ç•¥"
  âŒ TypeId ä¸å…¶ä»– SO æ¨¡æ¿é‡å¤ â†’ Error: "TypeId é‡å¤"
  âŒ Properties ä¸­æœ‰é‡å¤ Key â†’ Error: "å±æ€§ Key é‡å¤"
  âŒ SceneRequirements çš„ BindingKey åœ¨ Properties ä¸­æ— å¯¹åº” â†’ Warning
  âŒ OutputPorts ä¸­æœ‰é‡å¤ Id â†’ Error: "ç«¯å£ Id é‡å¤"
  âš ï¸ Properties æ•°é‡ > 15 â†’ Warning: "å±æ€§è¿‡å¤šï¼Œå»ºè®®æ‹†åˆ†"
```

#### 2.1.7 å±€é™æ€§

ActionTemplateSO **åªèƒ½å®šä¹‰èŠ‚ç‚¹çš„å…ƒæ•°æ®**ï¼ˆå¤–è§‚ã€å±æ€§ã€ç«¯å£ã€åœºæ™¯éœ€æ±‚ï¼‰ï¼Œ**ä¸èƒ½å®šä¹‰è¿è¡Œæ—¶è¡Œä¸º**ã€‚

å½“å¯¼å‡º JSON æ—¶ï¼ŒSO æ¨¡æ¿å®šä¹‰çš„èŠ‚ç‚¹ä¸ C# å®šä¹‰çš„èŠ‚ç‚¹äº§å‡ºç›¸åŒæ ¼å¼çš„æ•°æ®ã€‚è¿è¡Œæ—¶ Handler ä»éœ€ç¨‹åºå‘˜å®ç°ã€‚

```
ç­–åˆ’å¯ä»¥åšçš„ï¼š
  âœ… å®šä¹‰èŠ‚ç‚¹æœ‰å“ªäº›å±æ€§ï¼ˆfloatã€intã€enumã€sceneBinding ç­‰ï¼‰
  âœ… å®šä¹‰èŠ‚ç‚¹éœ€è¦ä»€ä¹ˆåœºæ™¯æ ‡è®°
  âœ… å®šä¹‰èŠ‚ç‚¹çš„ç«¯å£ï¼ˆè¾“å…¥/è¾“å‡ºï¼‰
  âœ… å®šä¹‰èŠ‚ç‚¹çš„åˆ†ç±»ã€é¢œè‰²ã€å›¾æ ‡
  âœ… åœ¨è“å›¾ä¸­ä½¿ç”¨è¯¥èŠ‚ç‚¹ã€ç¼–è¾‘å±æ€§ã€ç»‘å®šæ ‡è®°

ç­–åˆ’ä¸èƒ½åšçš„ï¼š
  âŒ å®šä¹‰èŠ‚ç‚¹è¿è¡Œæ—¶åšä»€ä¹ˆï¼ˆéœ€è¦ç¨‹åºå†™ Handlerï¼‰
  âŒ å®šä¹‰è‡ªå®šä¹‰ Gizmo æ¸²æŸ“ï¼ˆéœ€è¦ç¨‹åºå†™ IMarkerGizmoRendererï¼‰
  âŒ å®šä¹‰å¤æ‚çš„å±æ€§è”åŠ¨é€»è¾‘ï¼ˆVisibleWhen è¡¨è¾¾å¼è¦†ç›–ç®€å•åœºæ™¯ï¼‰
```

---

### 2.2 BlueprintTemplateSO â€” å­è“å›¾æ¨¡æ¿å¤ç”¨

#### 2.2.1 åŠ¨æœº

ç­–åˆ’ç»å¸¸åˆ›å»ºç›¸ä¼¼çš„è¡Œä¸ºæ¨¡å¼ï¼ˆå¦‚"æ ‡å‡†æˆ˜æ–—æ³¢æ¬¡"ã€"Boss æˆ˜å‰æ¼”å‡º"ï¼‰ï¼Œæ¯ä¸ªå…³å¡éƒ½è¦é‡æ–°æ­å»ºã€‚å­è“å›¾æ¨¡æ¿è®©ç­–åˆ’å°†å¸¸ç”¨æ¨¡å¼ä¿å­˜ä¸ºå¯å¤ç”¨èµ„äº§ã€‚

#### 2.2.2 æ•°æ®ç»“æ„

```csharp
/// <summary>
/// å­è“å›¾æ¨¡æ¿ï¼Œå­˜å‚¨ä¸€ä¸ªå¯å¤ç”¨çš„å­è“å›¾ï¼ˆèŠ‚ç‚¹ + è¿çº¿ + å…ƒæ•°æ®ï¼‰ã€‚
/// ç­–åˆ’é€šè¿‡"ä¿å­˜ä¸ºæ¨¡æ¿"åˆ›å»ºï¼Œé€šè¿‡"æ¨¡æ¿åº“"é¢æ¿æ‹–å…¥ä½¿ç”¨ã€‚
/// </summary>
[CreateAssetMenu(
    fileName = "NewBlueprintTemplate",
    menuName = "SceneBlueprint/Blueprint Template",
    order = 101)]
public class BlueprintTemplateSO : ScriptableObject
{
    [Header("â”€â”€ å…ƒæ•°æ® â”€â”€")]
    public string DisplayName;
    public string Category;              // å¦‚ "Combat", "Cinematic"

    [TextArea(2, 4)]
    public string Description;

    [Tooltip("ç¼©ç•¥å›¾ï¼ˆå¯é€‰ï¼Œè‡ªåŠ¨æˆªå›¾æˆ–æ‰‹åŠ¨æŒ‡å®šï¼‰")]
    public Texture2D Thumbnail;

    [Header("â”€â”€ å›¾æ•°æ® â”€â”€")]
    [HideInInspector]
    public string GraphJson;             // å­è“å›¾å†…éƒ¨çš„åºåˆ—åŒ– JSON

    [Header("â”€â”€ éœ€æ±‚å£°æ˜ â”€â”€")]
    [Tooltip("ä½¿ç”¨æ­¤æ¨¡æ¿æ—¶éœ€è¦ç»‘å®šçš„æ ‡è®°ç±»å‹")]
    public List<TemplateRequirement> Requirements = new();

    [Header("â”€â”€ ç»Ÿè®¡ï¼ˆåªè¯»ï¼‰ â”€â”€")]
    [ReadOnly] public int NodeCount;
    [ReadOnly] public string ActionTypes; // åŒ…å«çš„ Action ç±»å‹åˆ—è¡¨
    [ReadOnly] public string CreatedDate;
    [ReadOnly] public string LastModified;

    [Serializable]
    public class TemplateRequirement
    {
        public string BindingKey;         // æ¨¡æ¿å†…å¼•ç”¨çš„ç»‘å®šé”®
        public string MarkerTypeId;       // éœ€è¦çš„æ ‡è®°ç±»å‹
        public string Description;        // æè¿°ï¼ˆå¦‚"æˆ˜æ–—åŒºåŸŸ"ï¼‰
    }
}
```

#### 2.2.3 å·¥ä½œæµ

```
ä¿å­˜æ¨¡æ¿ï¼š
  1. ç­–åˆ’åœ¨è“å›¾ä¸­åˆ›å»ºä¸€ä¸ªå­è“å›¾ï¼ˆå¦‚"æ ‡å‡†æˆ˜æ–—æ³¢æ¬¡"ï¼‰
  2. å³é”®å­è“å›¾ â†’ "ä¿å­˜ä¸ºæ¨¡æ¿..."
  3. å¼¹å‡ºå¯¹è¯æ¡†ï¼šå¡«å†™åç§°ã€åˆ†ç±»ã€æè¿°
  4. ç³»ç»Ÿè‡ªåŠ¨ï¼š
     a. åºåˆ—åŒ–å­è“å›¾çš„ GraphJson
     b. æå–æ‰€æœ‰ SceneBinding å±æ€§ â†’ ç”Ÿæˆ Requirements
     c. ç»Ÿè®¡èŠ‚ç‚¹æ•°ã€Action ç±»å‹
     d. æˆªå–ç¼©ç•¥å›¾ï¼ˆå¯é€‰ï¼‰
     e. ä¿å­˜ä¸º .asset æ–‡ä»¶åˆ°æŒ‡å®šç›®å½•

ä½¿ç”¨æ¨¡æ¿ï¼š
  1. è“å›¾ç¼–è¾‘å™¨ä¸­æ‰“å¼€"æ¨¡æ¿åº“"é¢æ¿
  2. æµè§ˆåˆ†ç±» â†’ é¢„è§ˆæ¨¡æ¿ä¿¡æ¯ï¼ˆç¼©ç•¥å›¾ã€æè¿°ã€éœ€æ±‚ï¼‰
  3. æ‹–å…¥è“å›¾ç”»å¸ƒ â†’ è‡ªåŠ¨åˆ›å»ºå­è“å›¾ï¼š
     a. ååºåˆ—åŒ– GraphJson â†’ åˆ›å»ºèŠ‚ç‚¹å’Œè¿çº¿
     b. ç”Ÿæˆæ–°çš„èŠ‚ç‚¹ IDï¼ˆé¿å…å†²çªï¼‰
     c. ç”Ÿæˆæ–°çš„ MarkerIdï¼ˆé¿å…è·¨å…³å¡å†²çªï¼‰
     d. æç¤ºç­–åˆ’ç»‘å®šå¿…éœ€çš„åœºæ™¯æ ‡è®°
  4. ç­–åˆ’æ ¹æ®å½“å‰å…³å¡ç»‘å®šåœºæ™¯æ ‡è®° â†’ å®Œæˆ
```

#### 2.2.4 æ¨¡æ¿åº“é¢æ¿

```
â”Œâ”€ æ¨¡æ¿åº“ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ” [æœç´¢æ¨¡æ¿...]                                   â”‚
â”‚                                                    â”‚
â”‚ â–¾ Combatï¼ˆ3ï¼‰                                      â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚   â”‚ [ç¼©ç•¥å›¾] â”‚ â”‚ [ç¼©ç•¥å›¾] â”‚ â”‚ [ç¼©ç•¥å›¾] â”‚          â”‚
â”‚   â”‚æ ‡å‡†æˆ˜æ–—   â”‚ â”‚Bossæ¼”å‡º  â”‚ â”‚å¢æ´è§¦å‘  â”‚          â”‚
â”‚   â”‚æ³¢æ¬¡      â”‚ â”‚åºåˆ—      â”‚ â”‚         â”‚          â”‚
â”‚   â”‚ 5èŠ‚ç‚¹    â”‚ â”‚ 8èŠ‚ç‚¹    â”‚ â”‚ 3èŠ‚ç‚¹    â”‚          â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                    â”‚
â”‚ â–¸ Cinematicï¼ˆ2ï¼‰                                   â”‚
â”‚ â–¸ Environmentï¼ˆ1ï¼‰                                 â”‚
â”‚                                                    â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚ å·²é€‰ï¼šæ ‡å‡†æˆ˜æ–—æ³¢æ¬¡                                  â”‚
â”‚ æè¿°ï¼š3æ³¢é€’å¢åˆ·æ€ªï¼Œæ¯æ³¢é—´éš”å¯é…ç½®                    â”‚
â”‚ éœ€è¦ç»‘å®šï¼š                                         â”‚
â”‚   â€¢ åˆ·æ€ªåŒºåŸŸï¼ˆAreaï¼‰                               â”‚
â”‚   â€¢ åˆ·æ€ªç‚¹ Ã—3ï¼ˆPointï¼‰                             â”‚
â”‚                                                    â”‚
â”‚                    [æ‹–å…¥è“å›¾ä½¿ç”¨] [åœ¨è“å›¾ä¸­é¢„è§ˆ]     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 2.2.5 ID é‡æ˜ å°„

ä»æ¨¡æ¿å®ä¾‹åŒ–æ—¶ï¼Œå¿…é¡»é‡æ–°ç”Ÿæˆæ‰€æœ‰ ID ä»¥é¿å…å†²çªï¼š

```csharp
/// <summary>
/// ä»æ¨¡æ¿å®ä¾‹åŒ–å­è“å›¾æ—¶çš„ ID é‡æ˜ å°„ç­–ç•¥ã€‚
/// </summary>
public static class TemplateInstantiator
{
    public static SubGraphFrame Instantiate(
        BlueprintTemplateSO template,
        Graph targetGraph,
        Vector2 position)
    {
        // 1. ååºåˆ—åŒ–æ¨¡æ¿çš„å­å›¾
        var templateGraph = JsonGraphSerializer.Deserialize(template.GraphJson);

        // 2. æ„å»º ID æ˜ å°„è¡¨
        var idMap = new Dictionary<string, string>();
        foreach (var node in templateGraph.Nodes)
        {
            idMap[node.Id] = Guid.NewGuid().ToString();
        }

        // 3. é‡æ˜ å°„èŠ‚ç‚¹ IDã€è¾¹ IDã€MarkerId
        foreach (var node in templateGraph.Nodes)
        {
            node.Id = idMap[node.Id];

            // PropertyBag ä¸­çš„ MarkerId ä¹Ÿè¦é‡æ–°ç”Ÿæˆ
            if (node.UserData is ActionNodeData data)
            {
                foreach (var kvp in data.Properties.All)
                {
                    if (IsMarkerId(kvp.Value))
                    {
                        data.Properties.Set(kvp.Key, Guid.NewGuid().ToString());
                    }
                }
            }
        }

        // 4. é‡æ˜ å°„è¾¹çš„ç«¯ç‚¹å¼•ç”¨
        foreach (var edge in templateGraph.Edges)
        {
            edge.SourceNodeId = idMap.GetValueOrDefault(edge.SourceNodeId, edge.SourceNodeId);
            edge.TargetNodeId = idMap.GetValueOrDefault(edge.TargetNodeId, edge.TargetNodeId);
        }

        // 5. æ·»åŠ åˆ°ç›®æ ‡å›¾ä¸­ï¼Œåˆ›å»º SubGraphFrame
        // ...ï¼ˆä½¿ç”¨ç°æœ‰çš„ GroupNodesCommand é€»è¾‘ï¼‰

        return frame;
    }
}
```

#### 2.2.6 æ¨¡æ¿æ›´æ–°ç­–ç•¥

```
æ¨¡æ¿æ˜¯"å¿«ç…§"ï¼Œä¸æ˜¯"å¼•ç”¨"ï¼š
  - ä»æ¨¡æ¿å®ä¾‹åŒ–åï¼Œå­è“å›¾ä¸æ¨¡æ¿æ–­å¼€è”ç³»
  - ä¿®æ”¹æ¨¡æ¿ä¸ä¼šå½±å“å·²å®ä¾‹åŒ–çš„å­è“å›¾
  - ä¿®æ”¹å·²å®ä¾‹åŒ–çš„å­è“å›¾ä¸ä¼šå½±å“æ¨¡æ¿

åŸå› ï¼š
  - æ¯ä¸ªå…³å¡çš„æˆ˜æ–—é…ç½®ä¸åŒï¼Œæ¨¡æ¿åªæ˜¯èµ·ç‚¹
  - é¿å…"ä¿®æ”¹æ¨¡æ¿å¯¼è‡´æ‰€æœ‰å…³å¡è¢«å½±å“"çš„é£é™©
  - ç­–åˆ’å¯ä»¥å®‰å¿ƒåœ¨æ¨¡æ¿åŸºç¡€ä¸Šåšæœ¬åœ°åŒ–è°ƒæ•´

æœªæ¥å¯æ‰©å±•ï¼ˆä¸åœ¨æœ¬æœŸèŒƒå›´ï¼‰ï¼š
  - æ¨¡æ¿ç‰ˆæœ¬å· + "æ£€æŸ¥æ›´æ–°"åŠŸèƒ½
  - å·®å¼‚å¯¹æ¯”ï¼šå½“å‰å­è“å›¾ vs æœ€æ–°æ¨¡æ¿
```

---

## 3. Phase Bï¼šä½“éªŒä¼˜åŒ–ï¼ˆä¸­ä¼˜å…ˆçº§ï¼‰

### 3.1 GizmoStyleSO â€” Gizmo è§†è§‰å‚æ•°å¤–ç½®

#### 3.1.1 åŠ¨æœº

å½“å‰ Gizmo çš„é¢œè‰²ã€é€æ˜åº¦ã€å°ºå¯¸ç­‰å‚æ•°ç¡¬ç¼–ç åœ¨ `GizmoStyleConstants.cs` ä¸­ã€‚ç­–åˆ’æˆ– TA æƒ³è°ƒæ•´æ ‡è®°çš„è§†è§‰æ•ˆæœå¿…é¡»æ”¹ä»£ç ã€‚å°†è¿™äº›çº¯æ•°å€¼å‚æ•°å¤–ç½®ä¸º SOï¼Œå¯åœ¨ Inspector ä¸­å®æ—¶è°ƒæ•´ã€‚

#### 3.1.2 æ•°æ®ç»“æ„

```csharp
/// <summary>
/// Gizmo ç»˜åˆ¶æ ·å¼é…ç½®ã€‚åœºæ™¯ä¸­æœ‰ä¸”åªæœ‰ä¸€ä¸ªå®ä¾‹ï¼ˆå•ä¾‹ SOï¼‰ã€‚
/// </summary>
[CreateAssetMenu(
    fileName = "GizmoStyle",
    menuName = "SceneBlueprint/Gizmo Style",
    order = 200)]
public class GizmoStyleSO : ScriptableObject
{
    [Header("â”€â”€ å…¨å±€ â”€â”€")]
    public float GlobalAlpha = 1f;
    public bool ShowLabels = true;
    public float LabelFontSize = 12f;
    public float LabelBackgroundAlpha = 0.7f;

    [Header("â”€â”€ Point æ ‡è®° â”€â”€")]
    public Color PointColor = new(0.2f, 0.8f, 1f);
    public float PointRadius = 0.5f;
    public float PointArrowLength = 1.2f;
    public bool PointShowDirection = true;

    [Header("â”€â”€ Area æ ‡è®° â”€â”€")]
    public Color AreaColor = new(1f, 0.85f, 0.2f);
    public float AreaFillAlpha = 0.15f;
    public float AreaWireframeAlpha = 0.8f;
    public float AreaHeightLineAlpha = 0.3f;

    [Header("â”€â”€ Entity æ ‡è®° â”€â”€")]
    public Color EntityColor = new(0.4f, 1f, 0.4f);
    public float EntityIconSize = 0.8f;

    [Header("â”€â”€ é«˜äº®æ•ˆæœ â”€â”€")]
    public Color HighlightColor = new(1f, 0.95f, 0.3f);
    public float HighlightPulseSpeed = 3f;
    public float HighlightPulseMin = 0.5f;
    public float HighlightPulseMax = 1f;

    [Header("â”€â”€ é€‰ä¸­æ•ˆæœ â”€â”€")]
    public Color SelectionOutlineColor = Color.white;
    public float SelectionOutlineWidth = 2f;
}
```

#### 3.1.3 åŠ è½½ç­–ç•¥

```csharp
/// <summary>
/// GizmoStyleConstants æ”¹é€ ï¼šä¼˜å…ˆä» SO è¯»å–ï¼ŒSO ä¸å­˜åœ¨æ—¶ä½¿ç”¨ C# é»˜è®¤å€¼ã€‚
/// </summary>
public static class GizmoStyleConstants
{
    private static GizmoStyleSO _override;
    private static bool _searched;

    /// <summary>æŸ¥æ‰¾é¡¹ç›®ä¸­çš„ GizmoStyleSOï¼ˆå»¶è¿ŸåŠ è½½ï¼Œç¼“å­˜ç»“æœï¼‰</summary>
    private static GizmoStyleSO FindOverride()
    {
        if (!_searched)
        {
            _searched = true;
            var guids = AssetDatabase.FindAssets("t:GizmoStyleSO");
            if (guids.Length > 0)
            {
                var path = AssetDatabase.GUIDToAssetPath(guids[0]);
                _override = AssetDatabase.LoadAssetAtPath<GizmoStyleSO>(path);
                if (guids.Length > 1)
                    SBLog.Warning(SBLogTags.Gizmo,
                        $"å‘ç°å¤šä¸ª GizmoStyleSOï¼Œä½¿ç”¨ {path}");
            }
        }
        return _override;
    }

    // â”€â”€â”€ å…¬å¼€å±æ€§ï¼šSO è¦†ç›– > C# é»˜è®¤å€¼ â”€â”€â”€

    public static Color PointColor
        => FindOverride()?.PointColor ?? new Color(0.2f, 0.8f, 1f);

    public static float PointRadius
        => FindOverride()?.PointRadius ?? 0.5f;

    // ... å…¶ä»–å±æ€§åŒç†
}
```

**æ—  SO æ—¶è¡Œä¸ºä¸å˜**ï¼šå¦‚æœé¡¹ç›®ä¸­æ²¡æœ‰åˆ›å»º `GizmoStyleSO` èµ„äº§ï¼Œæ‰€æœ‰ Gizmo ä½¿ç”¨ C# ç¡¬ç¼–ç é»˜è®¤å€¼ï¼Œä¸æ”¹é€ å‰å®Œå…¨ä¸€è‡´ã€‚

---

### 3.2 MarkerPresetSO â€” æ ‡è®°é¢„è®¾é…ç½®

#### 3.2.1 åŠ¨æœº

ç­–åˆ’ä¸å¤ªéœ€è¦åˆ›å»ºå…¨æ–°çš„æ ‡è®°ç±»å‹ï¼ˆPoint/Area/Entity å·²è¦†ç›–å¤§å¤šæ•°åœºæ™¯ï¼‰ï¼Œä½†éœ€è¦åˆ›å»º**åŒç±»å‹çš„è¯­ä¹‰å˜ä½“**ï¼š

- "ç²¾è‹±åˆ·æ€ªç‚¹" = PointMarker + çº¢è‰² + Tag="Combat.Elite"
- "å®‰å…¨åŒºåŸŸ" = AreaMarker + ç»¿è‰² + Tag="Safe.Zone"
- "æ‘„åƒæœºä½" = PointMarker + è“è‰² + Tag="Camera.Position"

#### 3.2.2 æ•°æ®ç»“æ„

```csharp
/// <summary>
/// æ ‡è®°é¢„è®¾ï¼Œæè¿°å·²æœ‰æ ‡è®°ç±»å‹çš„ä¸€ç§è¯­ä¹‰å˜ä½“ã€‚
/// ä¸åˆ›å»ºæ–°çš„ MarkerTypeï¼Œè€Œæ˜¯ä¸ºå·²æœ‰ç±»å‹æä¾›é¢„é…ç½®ã€‚
/// </summary>
[CreateAssetMenu(
    fileName = "NewMarkerPreset",
    menuName = "SceneBlueprint/Marker Preset",
    order = 102)]
public class MarkerPresetSO : ScriptableObject
{
    [Header("â”€â”€ åŸºç¡€ â”€â”€")]
    [Tooltip("é¢„è®¾ IDï¼Œå…¨å±€å”¯ä¸€")]
    public string PresetId;

    [Tooltip("æ˜¾ç¤ºåç§°")]
    public string DisplayName;

    [Tooltip("åŸºç¡€æ ‡è®°ç±»å‹ IDï¼ˆPoint / Area / Entityï¼‰")]
    public string BaseMarkerTypeId;

    [Header("â”€â”€ é»˜è®¤å€¼ â”€â”€")]
    [Tooltip("è‡ªåŠ¨åˆ†é…çš„ Tag")]
    public string DefaultTag;

    [Tooltip("è‡ªåŠ¨åˆ†é…çš„åç§°å‰ç¼€")]
    public string NamePrefix;

    [Tooltip("Gizmo é¢œè‰²è¦†ç›–ï¼ˆå¯é€‰ï¼‰")]
    public Color? GizmoColorOverride;

    [Header("â”€â”€ Area ç‰¹æœ‰ â”€â”€")]
    [Tooltip("é»˜è®¤åŒºåŸŸå½¢çŠ¶")]
    public AreaShape DefaultAreaShape = AreaShape.Box;

    [Tooltip("é»˜è®¤ Box å°ºå¯¸")]
    public Vector3 DefaultBoxSize = new(8f, 3f, 8f);

    [Header("â”€â”€ Entity ç‰¹æœ‰ â”€â”€")]
    [Tooltip("é»˜è®¤ Prefab")]
    public GameObject DefaultPrefab;

    [Tooltip("é»˜è®¤æ•°é‡")]
    public int DefaultCount = 1;
}
```

#### 3.2.3 ä¸åˆ›å»ºæµç¨‹çš„é›†æˆ

```
å½“å‰åˆ›å»ºæµç¨‹ï¼ˆSceneViewMarkerToolï¼‰ï¼š
  Shift+å³é”® â†’ é€‰æ‹© Action ç±»å‹ â†’ æ ¹æ® MarkerRequirement åˆ›å»ºæ ‡è®°

æ”¹é€ åï¼š
  Shift+å³é”® â†’ é€‰æ‹© Action ç±»å‹ â†’ æ ¹æ® MarkerRequirement æŸ¥æ‰¾åŒ¹é…çš„é¢„è®¾
    â†’ å¦‚æœæœ‰é¢„è®¾ï¼šåº”ç”¨é¢„è®¾çš„é»˜è®¤å€¼ï¼ˆTagã€é¢œè‰²ã€å°ºå¯¸ç­‰ï¼‰
    â†’ å¦‚æœæ— é¢„è®¾ï¼šä½¿ç”¨æ ‡å‡†é»˜è®¤å€¼ï¼ˆä¸å½“å‰è¡Œä¸ºä¸€è‡´ï¼‰

é¢„è®¾åŒ¹é…è§„åˆ™ï¼š
  MarkerRequirement.MarkerTypeId + MarkerRequirement.DefaultTag
  â†’ æŸ¥æ‰¾ BaseMarkerTypeId åŒ¹é… ä¸” DefaultTag åŒ¹é…ï¼ˆæˆ–ä¸ºç©ºï¼‰çš„é¢„è®¾
```

---

## 4. Phase Cï¼šé”¦ä¸Šæ·»èŠ±ï¼ˆä½ä¼˜å…ˆçº§ï¼‰

### 4.1 CategorySO â€” èŠ‚ç‚¹åˆ†ç±»ä½“ç³»

#### 4.1.1 æ•°æ®ç»“æ„

```csharp
/// <summary>
/// èŠ‚ç‚¹åˆ†ç±»å®šä¹‰ã€‚ç®¡ç†å³é”®èœå•åˆ†ç»„ã€èŠ‚ç‚¹é¢œè‰²ã€æ’åºã€‚
/// </summary>
[CreateAssetMenu(
    fileName = "NewCategory",
    menuName = "SceneBlueprint/Category",
    order = 103)]
public class CategorySO : ScriptableObject
{
    public string CategoryId;        // å¦‚ "Combat"
    public string DisplayName;       // å¦‚ "æˆ˜æ–—"
    public Color ThemeColor;         // åˆ†ç±»ä¸»é¢˜è‰²ï¼ˆèŠ‚ç‚¹é»˜è®¤ä½¿ç”¨æ­¤è‰²ï¼‰
    public string Icon;              // å›¾æ ‡
    public int SortOrder;            // æ’åºæƒé‡ï¼ˆè¶Šå°è¶Šé å‰ï¼‰

    [TextArea(1, 3)]
    public string Description;       // åˆ†ç±»æè¿°
}
```

#### 4.1.2 é›†æˆæ–¹å¼

- å³é”®èœå•æŒ‰ `SortOrder` æ’åºåˆ†ç±»
- ActionDefinition/ActionTemplateSO ä¸­çš„ `Category` å­—ç¬¦ä¸²åŒ¹é… `CategorySO.CategoryId`
- å¦‚æœ ActionDefinition æœªæŒ‡å®š `ThemeColor`ï¼Œä» CategorySO ç»§æ‰¿

### 4.2 ValidationRuleSO â€” å¯é…ç½®éªŒè¯è§„åˆ™

#### 4.2.1 æ•°æ®ç»“æ„

```csharp
/// <summary>
/// å¯é…ç½®çš„è“å›¾éªŒè¯è§„åˆ™ã€‚è¡¥å……æ¡†æ¶å†…ç½®çš„ç»“æ„éªŒè¯ã€‚
/// </summary>
[CreateAssetMenu(
    fileName = "NewValidationRule",
    menuName = "SceneBlueprint/Validation Rule",
    order = 104)]
public class ValidationRuleSO : ScriptableObject
{
    public string RuleId;
    public string Description;
    public ValidationSeverity Severity = ValidationSeverity.Warning;

    [Tooltip("è§„åˆ™ç±»å‹")]
    public ValidationType Type;

    [Header("â”€â”€ å‚æ•°ï¼ˆæŒ‰ Type å¡«å†™ï¼‰ â”€â”€")]
    [Tooltip("ç›®æ ‡ Action TypeIdï¼ˆType=PropertyRequired/BindingRequired æ—¶ï¼‰")]
    public string TargetActionTypeId;

    [Tooltip("ç›®æ ‡å±æ€§ Keyï¼ˆType=PropertyRequired æ—¶ï¼‰")]
    public string TargetPropertyKey;

    [Tooltip("å­è“å›¾æœ€å°‘èŠ‚ç‚¹æ•°ï¼ˆType=MinNodesInSubGraph æ—¶ï¼‰")]
    public int MinNodeCount = 1;
}

public enum ValidationType
{
    PropertyRequired,      // æŒ‡å®š Action çš„æŒ‡å®šå±æ€§å¿…é¡»éç©º
    BindingRequired,       // æŒ‡å®š Action çš„æ‰€æœ‰ SceneBinding å¿…é¡»å·²ç»‘å®š
    MinNodesInSubGraph,    // å­è“å›¾å†…è‡³å°‘ N ä¸ªèŠ‚ç‚¹
}

public enum ValidationSeverity
{
    Info,
    Warning,
    Error
}
```

---

## 5. é…ç½®ç®¡ç†çª—å£ï¼ˆConfigurationWindowï¼Œå·²åœ¨ C7 ä¸‹çº¿ï¼‰

### 5.1 åŠ¨æœº

ç­–åˆ’é€šè¿‡ Project çª—å£åˆ›å»ºå’Œç¼–è¾‘ SO æ–‡ä»¶å­˜åœ¨ä»¥ä¸‹ç—›ç‚¹ï¼š
- **åˆ†æ•£**ï¼šæ¨¡æ¿æ•£è½åœ¨é¡¹ç›®ä¸­ï¼Œæ²¡æœ‰ç»Ÿä¸€å…¥å£
- **ä¸Šä¸‹æ–‡ç¼ºå¤±**ï¼šå¡« Category æ—¶ä¸çŸ¥é“å·²æœ‰å“ªäº›åˆ†ç±»ï¼Œå¡« TypeId æ—¶ä¸çŸ¥é“å“ªäº›å·²è¢«å ç”¨
- **å‘ç°æ€§å·®**ï¼šæ–°ç­–åˆ’ä¸çŸ¥é“ä»å“ªåˆ›å»ºæ¨¡æ¿

### 5.2 çª—å£å¸ƒå±€

```
â”Œâ”€ SceneBlueprint é…ç½®ç®¡ç† â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [åˆ·æ–°]                                          ğŸ” [æœç´¢...]        â”‚
â”‚  [Action æ¨¡æ¿] [è“å›¾æ¨¡æ¿]                                            â”‚
â”‚ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â”‚
â”‚ â”Œâ”€ å·¦ä¾§åˆ—è¡¨ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”Œâ”€ å³ä¾§ç¼–è¾‘ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”‚ [+ æ–°å»º Action æ¨¡æ¿]  â”‚ â”‚ â”‚ æ’­æ”¾æ—¶é—´çº¿  [SO æ¨¡æ¿ - å¯ç¼–è¾‘]     â”‚  â”‚
â”‚ â”‚                      â”‚ â”‚ â”‚                                    â”‚  â”‚
â”‚ â”‚ â–¾ Combat (3)         â”‚ â”‚ â”‚ TypeId: [Cinematic.PlayTimeline]    â”‚  â”‚
â”‚ â”‚   â–  åˆ·æ€ª       C#    â”‚ â”‚ â”‚ åç§°:   [æ’­æ”¾æ—¶é—´çº¿]                â”‚  â”‚
â”‚ â”‚   â–  æ”¾ç½®é¢„è®¾æ€ª  C#    â”‚ â”‚ â”‚ åˆ†ç±»:   [Cinematic] [â–¼]            â”‚  â”‚
â”‚ â”‚   â–  è¡Œè¿›é—´åˆ·æ€ª  C#    â”‚ â”‚ â”‚ é¢œè‰²:   [â–  ç´«è‰²]                  â”‚  â”‚
â”‚ â”‚ â–¾ Cinematic (1)      â”‚ â”‚ â”‚ æ—¶é•¿:   [Duration â–¼]              â”‚  â”‚
â”‚ â”‚   â–  æ’­æ”¾æ—¶é—´çº¿  SO    â”‚ â”‚ â”‚                                    â”‚  â”‚
â”‚ â”‚ â–¾ Flow (3)           â”‚ â”‚ â”‚ â”€â”€ å±æ€§åˆ—è¡¨ â”€â”€                      â”‚  â”‚
â”‚ â”‚   â–  å¼€å§‹       C#    â”‚ â”‚ â”‚ [å±•å¼€/ç¼–è¾‘å±æ€§...]                  â”‚  â”‚
â”‚ â”‚   â–  ç»“æŸ       C#    â”‚ â”‚ â”‚                                    â”‚  â”‚
â”‚ â”‚   â–  å»¶è¿Ÿ       C#    â”‚ â”‚ â”‚ â”€â”€ åœºæ™¯éœ€æ±‚ â”€â”€                      â”‚  â”‚
â”‚ â”‚                      â”‚ â”‚ â”‚ [å±•å¼€/ç¼–è¾‘åœºæ™¯éœ€æ±‚...]              â”‚  â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚                                    â”‚  â”‚
â”‚                          â”‚ â”‚ [åœ¨ Project ä¸­å®šä½]  [åˆ é™¤æ¨¡æ¿]     â”‚  â”‚
â”‚                          â”‚ â”‚                                    â”‚  â”‚
â”‚                          â”‚ â”‚ âœ… éªŒè¯é€šè¿‡                         â”‚  â”‚
â”‚                          â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚ Action å®šä¹‰: 7 (C#: 6, æ¨¡æ¿: 1) | è“å›¾æ¨¡æ¿: 0                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.3 æ ¸å¿ƒç‰¹æ€§

- **åŒæ å¸ƒå±€**ï¼šå·¦ä¾§åˆ†ç±»åˆ—è¡¨ + å³ä¾§ç¼–è¾‘é¢æ¿ï¼Œå¯æ‹–æ‹½åˆ†å‰²æ¡è°ƒæ•´æ¯”ä¾‹
- **æ ‡ç­¾é¡µæ‰©å±•**ï¼šå½“å‰ä¸¤ä¸ªæ ‡ç­¾é¡µï¼ˆAction æ¨¡æ¿ / è“å›¾æ¨¡æ¿ï¼‰ï¼ŒPhase B/C å¯æ·»åŠ æ›´å¤š
- **C# å®šä¹‰åªè¯»æŸ¥çœ‹**ï¼šC# å®šä¹‰æ ‡è®°ä¸º `C#`ï¼Œç‚¹å‡»åå³ä¾§æ˜¾ç¤ºåªè¯»è¯¦æƒ…ï¼ˆç«¯å£ã€å±æ€§ã€åœºæ™¯éœ€æ±‚ï¼‰
- **SO æ¨¡æ¿å¯ç¼–è¾‘**ï¼šSO æ¨¡æ¿æ ‡è®°ä¸º `SO`ï¼Œå³ä¾§ä½¿ç”¨ SerializedProperty ç»˜åˆ¶ï¼Œæ”¯æŒ Undo
- **Category ä¸‹æ‹‰é€‰æ‹©å™¨**ï¼šè‡ªåŠ¨æ”¶é›†æ‰€æœ‰å·²æœ‰åˆ†ç±»ï¼Œç­–åˆ’ä¸éœ€è¦æ‰‹è¾“å­—ç¬¦ä¸²
- **å†…è”éªŒè¯**ï¼šTypeId å”¯ä¸€æ€§ã€å¿…å¡«é¡¹æ£€æŸ¥ã€æ ¼å¼æ ¡éªŒå®æ—¶æ˜¾ç¤ºåœ¨ç¼–è¾‘é¢æ¿åº•éƒ¨
- **ä¸€é”®æ–°å»º**ï¼š`[+ æ–°å»º Action æ¨¡æ¿]` è‡ªåŠ¨åˆ›å»º .asset åˆ°æŒ‡å®šç›®å½•å¹¶é€‰ä¸­
- **æœç´¢è¿‡æ»¤**ï¼šæŒ‰åç§°ã€TypeIdã€åˆ†ç±»æ¨¡ç³Šæœç´¢

### 5.4 å…¥å£

- C7 èµ·å·²ç§»é™¤è¯¥çª—å£å…¥å£ï¼ˆèœå•ä¸å·¥å…·æ æŒ‰é’®å‡åˆ é™¤ï¼‰ï¼Œç»Ÿä¸€ç”±å·¥ä½œå°æ‰¿æ¥ä¸»æµç¨‹ã€‚

### 5.5 å®ç°æ–‡ä»¶

> å†å²å®ç°ï¼š`Editor/Templates/ConfigurationWindow.cs`ï¼ˆå·²åœ¨ C7 æ¸…ç†é˜¶æ®µåˆ é™¤ï¼‰

---

## 6. ç›®å½•ç»“æ„

```
Assets/Extensions/SceneBlueprint/
  â”œâ”€â”€ Editor/
  â”‚   â”œâ”€â”€ Templates/                               â† æ¨¡æ¿ç³»ç»Ÿç¼–è¾‘å™¨ä»£ç 
  â”‚   â”‚   â”œâ”€â”€ ActionTemplateConverter.cs            â† SO â†’ ActionDefinition è½¬æ¢
  â”‚   â”‚   â”œâ”€â”€ ActionTemplateSOEditor.cs             â† è‡ªå®šä¹‰ Inspectorï¼ˆéªŒè¯+é¢„è§ˆï¼‰
  â”‚   â”‚   â”œâ”€â”€ BlueprintTemplateUtils.cs             â† ä¿å­˜æ¨¡æ¿ + å®ä¾‹åŒ– + ID é‡æ˜ å°„
  â”‚   â”‚   â”œâ”€â”€ BlueprintTemplateSOEditor.cs          â† è“å›¾æ¨¡æ¿è‡ªå®šä¹‰ Inspector
  â”‚   â”‚   â”œâ”€â”€ MarkerPresetRegistry.cs               â† é¢„è®¾æŸ¥æ‰¾å·¥å…·ï¼ˆæŒ‰ TypeId+Tag åŒ¹é…ï¼‰
  â”‚   â”‚   â”œâ”€â”€ CategoryRegistry.cs                   â† åˆ†ç±»æ³¨å†Œè¡¨ï¼ˆæ’åº + ThemeColor æŸ¥æ‰¾ï¼‰
  â”‚   â”‚   â”œâ”€â”€ ValidationRuleRegistry.cs             â† éªŒè¯è§„åˆ™æ³¨å†Œè¡¨
  â”‚   â”‚   â””â”€â”€ ï¼ˆConfigurationWindow.cs å·²åœ¨ C7 åˆ é™¤ï¼‰
  â”‚   â””â”€â”€ ...
  â”‚
  â”œâ”€â”€ Runtime/
  â”‚   â”œâ”€â”€ Templates/                               â† SO å®šä¹‰ï¼ˆéœ€è¦ Runtime å¼•ç”¨ï¼‰
  â”‚   â”‚   â”œâ”€â”€ ActionTemplateSO.cs                   â† âœ… å·²å®ç°
  â”‚   â”‚   â”œâ”€â”€ BlueprintTemplateSO.cs                â† âœ… å·²å®ç°
  â”‚   â”‚   â”œâ”€â”€ GizmoStyleSO.cs                       â† âœ… å·²å®ç°
  â”‚   â”‚   â”œâ”€â”€ MarkerPresetSO.cs                     â† âœ… å·²å®ç°
  â”‚   â”‚   â”œâ”€â”€ CategorySO.cs                         â† âœ… å·²å®ç°
  â”‚   â”‚   â””â”€â”€ ValidationRuleSO.cs                   â† âœ… å·²å®ç°
  â”‚   â””â”€â”€ ...
  â”‚
  â”œâ”€â”€ Templates/                                   â† ç­–åˆ’åˆ›å»ºçš„æ¨¡æ¿èµ„äº§ï¼ˆ.asset æ–‡ä»¶ï¼‰
  â”‚   â”œâ”€â”€ Actions/                                 â† ActionTemplateSO èµ„äº§
  â”‚   â”œâ”€â”€ Blueprints/                              â† BlueprintTemplateSO èµ„äº§
  â”‚   â”œâ”€â”€ MarkerPresets/                           â† MarkerPresetSO èµ„äº§
  â”‚   â”œâ”€â”€ GizmoStyle.asset                         â† GizmoStyleSOï¼ˆå”¯ä¸€ï¼‰
  â”‚   â”œâ”€â”€ Categories/                              â† CategorySO èµ„äº§
  â”‚   â””â”€â”€ ValidationRules/                         â† ValidationRuleSO èµ„äº§
  â””â”€â”€ ...
```

---

## 7. å®æ–½è·¯çº¿

### Phase Aï¼šæ ¸å¿ƒæ¨¡æ¿ â­â­â­ï¼ˆâœ… å·²å®Œæˆï¼‰

```
A1. ActionTemplateSO âœ…
  a1. ActionTemplateSO æ•°æ®ç±» + CreateAssetMenu               âœ…
  a2. ActionTemplateConverterï¼ˆSO â†’ ActionDefinitionï¼‰          âœ…
  a3. SceneBlueprintProfile æ‰©å±•ï¼ˆåˆå¹¶ C# + SOï¼ŒC# ä¼˜å…ˆï¼‰      âœ…
  a4. ActionTemplateSO è‡ªå®šä¹‰ Inspectorï¼ˆéªŒè¯ + èŠ‚ç‚¹é¢„è§ˆï¼‰      âœ…

A2. BlueprintTemplateSO âœ…
  a1. BlueprintTemplateSO æ•°æ®ç±»                               âœ…
  a2. BlueprintTemplateUtilsï¼ˆä¿å­˜ä¸ºæ¨¡æ¿ + å®ä¾‹åŒ– + ID é‡æ˜ å°„ï¼‰ âœ…
  a3. è“å›¾ç¼–è¾‘å™¨é›†æˆï¼ˆå­è“å›¾å³é”®"ä¿å­˜ä¸ºæ¨¡æ¿" + ç”»å¸ƒå³é”®"ä»æ¨¡æ¿åˆ›å»º"ï¼‰ âœ…
  a4. BlueprintTemplateSO è‡ªå®šä¹‰ Inspector                     âœ…

A3. é…ç½®ç®¡ç†çª—å£ï¼ˆå†å²èƒ½åŠ›ï¼ŒC7 å·²ä¸‹çº¿ï¼‰ âœ…
  a1. ConfigurationWindow æ¡†æ¶ï¼ˆæ ‡ç­¾é¡µ + åŒæ  + å¯æ‹–æ‹½åˆ†å‰²æ¡ï¼‰  âœ…
  a2. Action æ¨¡æ¿æ ‡ç­¾é¡µï¼ˆC# åªè¯» + SO ç¼–è¾‘ + Category ä¸‹æ‹‰ + éªŒè¯ï¼‰ âœ…
  a3. è“å›¾æ¨¡æ¿æ ‡ç­¾é¡µï¼ˆåˆ—è¡¨ + é¢„è§ˆ + å…ƒæ•°æ®ç¼–è¾‘ + åˆ é™¤ï¼‰        âœ…
  a4. è“å›¾ç¼–è¾‘å™¨å·¥å…·æ  [é…ç½®] æŒ‰é’®å…¥å£ï¼ˆå·²åœ¨ C7 ç§»é™¤ï¼‰         âœ…
  a5. èœå•å…¥å£ï¼ˆSceneBlueprint â†’ é…ç½®ç®¡ç†ï¼Œå·²åœ¨ C7 ç§»é™¤ï¼‰      âœ…
```

### Phase Bï¼šä½“éªŒä¼˜åŒ– â­â­ï¼ˆâœ… å·²å®Œæˆï¼‰

```
B1. GizmoStyleSO âœ…
  b1. GizmoStyleSO æ•°æ®ç±» + CreateAssetMenu                            âœ…
  b2. GizmoStyleConstants æ”¹é€ ï¼ˆå»¶è¿ŸåŠ è½½ + ç¼“å­˜ + SO è¦†ç›– > C# é»˜è®¤å€¼ï¼‰ âœ…
  b3. é…ç½®ç®¡ç†çª—å£ Gizmo æ ·å¼æ ‡ç­¾é¡µï¼ˆåˆ›å»º/ç¼–è¾‘/é‡ç½®ï¼‰          âœ…

B2. MarkerPresetSO âœ…
  b1. MarkerPresetSO æ•°æ®ç±» + CreateAssetMenu                           âœ…
  b2. MarkerPresetRegistry é¢„è®¾æŸ¥æ‰¾å·¥å…·ï¼ˆæŒ‰ TypeId+Tag åŒ¹é…ï¼‰          âœ…
  b3. SceneViewMarkerTool é›†æˆï¼ˆåˆ›å»ºæ—¶æŸ¥æ‰¾é¢„è®¾å¹¶åº”ç”¨é»˜è®¤å€¼ï¼‰        âœ…
  b4. é…ç½®ç®¡ç†çª—å£æ ‡è®°é¢„è®¾æ ‡ç­¾é¡µï¼ˆåˆ—è¡¨/ç¼–è¾‘/éªŒè¯/æ–°å»º/åˆ é™¤ï¼‰    âœ…
```

### Phase Cï¼šé”¦ä¸Šæ·»èŠ± â­ï¼ˆâœ… å·²å®Œæˆï¼‰

```
C1. CategorySO âœ…
  c1. CategorySO æ•°æ®ç±» + CreateAssetMenu                              âœ…
  c2. CategoryRegistry æ³¨å†Œè¡¨ï¼ˆåŠ è½½ + æŸ¥æ‰¾ + æ’åºæƒé‡ï¼‰              âœ…
  c3. å³é”®èœå•æ’åºé›†æˆï¼ˆæŒ‰ SortOrder æ’åºï¼Œæ—  SO æ—¶å­—æ¯åºï¼‰   âœ…
  c4. ThemeColor ç»§æ‰¿é€»è¾‘ï¼ˆAction é»˜è®¤ç°è‰²æ—¶ä» CategorySO ç»§æ‰¿ï¼‰ âœ…
  c5. é…ç½®ç®¡ç†çª—å£åˆ†ç±»æ ‡ç­¾é¡µï¼ˆåˆ—è¡¨/ç¼–è¾‘/æ–°å»º/åˆ é™¤ï¼‰         âœ…

C2. ValidationRuleSO âœ…
  c1. ValidationRuleSO æ•°æ®ç±» + æšä¸¾ (ValidationType/ValidationSeverity)  âœ…
  c2. ValidationRuleRegistry æ³¨å†Œè¡¨ï¼ˆåŠ è½½ + å¯ç”¨è¿‡æ»¤ï¼‰                  âœ…
  c3. BlueprintExporter éªŒè¯å¼•æ“æ‰©å±•ï¼ˆåˆå¹¶ C# + SO è§„åˆ™ï¼‰            âœ…
  c4. ä¸‰ç§è§„åˆ™ç±»å‹å®ç°: PropertyRequired/BindingRequired/MinNodes  âœ…
  c5. é…ç½®ç®¡ç†çª—å£éªŒè¯è§„åˆ™æ ‡ç­¾é¡µï¼ˆåˆ†ç»„åˆ—è¡¨/æ¡ä»¶ç¼–è¾‘/æ–°å»º/åˆ é™¤ï¼‰ âœ…
```

---

## 8. å·²ç¡®è®¤å†³ç­–

| # | é—®é¢˜ | å†³ç­– |
|---|------|------|
| T1 | æ˜¯å¦å¼•å…¥è„šæœ¬è¯­è¨€ï¼ˆLua/JSï¼‰ | **ä¸å¼•å…¥**ã€‚SceneBlueprint æ˜¯ç¼–è¾‘å™¨å·¥å…·ï¼Œæ— è¿è¡Œæ—¶çƒ­æ›´æ–°éœ€æ±‚ã€‚SO æ•°æ®é©±åŠ¨è¶³å¤Ÿ |
| T2 | SO ä¸ C# å®šä¹‰å†²çªæ—¶è°ä¼˜å…ˆ | **C# ä¼˜å…ˆ**ã€‚SO æ¨¡æ¿ä½œä¸ºè¡¥å……ï¼Œä¸è¦†ç›–ç¨‹åºå®šä¹‰ |
| T3 | å­è“å›¾æ¨¡æ¿æ˜¯å¼•ç”¨è¿˜æ˜¯å¿«ç…§ | **å¿«ç…§**ã€‚å®ä¾‹åŒ–åæ–­å¼€è”ç³»ï¼Œä¿®æ”¹æ¨¡æ¿ä¸å½±å“å·²æœ‰å…³å¡ |
| T4 | SO æ–‡ä»¶æ”¾åœ¨å“ªä¸ªç¨‹åºé›† | **Runtime**ã€‚SO éœ€è¦åœ¨åœºæ™¯ä¸­è¢«å¼•ç”¨ï¼ˆå¦‚ MarkerPreset å¯èƒ½è¢« Manager è¯»å–ï¼‰ |
| T5 | GizmoStyleSO æ˜¯å¦å¿…é¡»å­˜åœ¨ | **è‡ªåŠ¨åˆ›å»º**ã€‚GizmoStyleInitializer å¯åŠ¨æ—¶æ£€æŸ¥å¹¶åˆ›å»ºé»˜è®¤ SOï¼ŒC# ä¿ç•™å›é€€å®‰å…¨ç½‘ |
| T6 | æ¨¡æ¿ç®¡ç† UI æ–¹æ¡ˆ | **ç‹¬ç«‹é…ç½®ç®¡ç†çª—å£**ï¼ˆæ–¹æ¡ˆ Aï¼‰ã€‚ç»Ÿä¸€å…¥å£ã€åŒæ å¸ƒå±€ã€æ ‡ç­¾é¡µå¯æ‰©å±• |
| T7 | ActionTemplateSO é¢„è§ˆ | **é…ç½®çª—å£å†…åµŒ**ã€‚C# å®šä¹‰åªè¯»æŸ¥çœ‹ã€SO æ¨¡æ¿ç›´æ¥ç¼–è¾‘ |
| T8 | æ¨¡æ¿åº“é¢æ¿æ”¾åœ¨å“ªé‡Œ | **é…ç½®ç®¡ç†çª—å£çš„è“å›¾æ¨¡æ¿æ ‡ç­¾é¡µ** + ç”»å¸ƒå³é”®èœå•ã€Œä»æ¨¡æ¿åˆ›å»ºã€å­èœå• |
| T9 | MarkerPresetSO å®šä½ | **æ ‡è®°é…ç½®ä¸­å¿ƒ**ã€‚MarkerRequirement é€šè¿‡ PresetId å¼•ç”¨é¢„è®¾ï¼Œåˆ›å»ºå‚æ•°å…¨éƒ¨ç”± SO æ§åˆ¶ |
| T10 | Action ä¸ Marker å…³ç³» | **å£°æ˜/åˆ›å»º/ç»‘å®šä¸‰å±‚åˆ†ç¦»**ã€‚Action å£°æ˜ç»“æ„å¥‘çº¦(PresetId)ï¼ŒPresetSO æ§åˆ¶åˆ›å»ºé…ç½®ï¼ŒSceneBinding å¤„ç†ç»‘å®š |

---

## 9. Phase Dï¼šæ ‡è®°é¢„è®¾æ¶æ„ä¼˜åŒ–ï¼ˆâœ… å·²å®Œæˆï¼‰

### æ ¸å¿ƒæ€è·¯

å°†æ ‡è®°åˆ›å»ºçš„"å£°æ˜"ï¼ˆAction éœ€è¦ä»€ä¹ˆæ ‡è®°ï¼‰å’Œ"é…ç½®"ï¼ˆæ ‡è®°é•¿ä»€ä¹ˆæ ·ï¼‰åˆ†ç¦»ï¼š
- **MarkerRequirement** åªä¿ç•™ç»“æ„å¥‘çº¦ï¼ˆBindingKey, MarkerTypeId, Required, PresetIdï¼‰
- **MarkerPresetSO** æˆä¸ºæ ‡è®°åˆ›å»ºçš„**å”¯ä¸€é…ç½®æº**ï¼ˆåç§°ã€é¢œè‰²ã€å°ºå¯¸ã€Tagï¼‰

### å˜æ›´æ¸…å•

```
D1. MarkerRequirement ç˜¦èº«                                    âœ…
  - æ–°å¢ PresetId å¼•ç”¨é¢„è®¾
  - DisplayName/DefaultTag é™çº§ä¸ºå‘åå…¼å®¹å›é€€å­—æ®µ
  - æ–°å¢æ¨èæ„é€ å‡½æ•°ï¼ˆä½¿ç”¨ PresetIdï¼‰

D2. MarkerPresetRegistry å¢å¼º                                 âœ…
  - æ–°å¢ FindByPresetId ç²¾ç¡®æŸ¥æ‰¾æ–¹æ³•

D3. SceneViewMarkerTool é‡æ„                                  âœ…
  - åˆ›å»ºæµç¨‹ï¼šPresetId â†’ FindByPresetId â†’ åº”ç”¨ SO é…ç½®
  - åç§°/Tag ä¼˜å…ˆçº§ï¼šPresetSO > MarkerRequirement > é»˜è®¤
  - é¢œè‰²ä¼˜å…ˆçº§ï¼šMarker è‡ªå®šä¹‰è‰²ï¼ˆå«é¢„è®¾å†™å…¥ï¼‰ > å›¾å±‚é¢œè‰² > é»˜è®¤é¢œè‰²
  - æ–°å¢ ResolvePreset / ResolveDisplayName è¾…åŠ©æ–¹æ³•
  - æ–°å¢ CreateStandaloneMarkerFromPreset ä»é¢„è®¾åˆ›å»ºç‹¬ç«‹æ ‡è®°

D4. ActionTemplateSO åŒæ­¥                                     âœ…
  - SceneRequirementEntry æ–°å¢ PresetRefï¼ˆObjectField æ‹–æ‹½ï¼‰
  - æ—§å­—æ®µé™çº§ä¸ºå‘åå…¼å®¹

D5. ActionTemplateConverter åŒæ­¥                              âœ…
  - PresetRef â†’ PresetId æ˜ å°„

D6. C# ActionDefs æ›´æ–°                                        âœ…
  - SpawnActionDef / PlacePresetActionDef æ”¹ç”¨ PresetId

D7. MarkerPresetInitializer                                   âœ…
  - è‡ªåŠ¨åˆ›å»º 3 ä¸ªé»˜è®¤é¢„è®¾ï¼šCombat.SpawnArea / SpawnPoint / PresetPoint
  - èœå•å…¥å£ï¼šSceneBlueprint â†’ åˆ›å»ºé»˜è®¤æ ‡è®°é¢„è®¾

D8. ä»…åˆ›å»ºæ ‡è®°èœå•ç”±é¢„è®¾é©±åŠ¨                                    âœ…
  - æŒ‰é¢„è®¾åˆ†ç±»åˆ†ç»„æ˜¾ç¤º
  - ä¿ç•™ç©ºç™½ Point/Area/Entity è£¸åˆ›å»ºé€‰é¡¹

D9. ConfigurationWindow æ ‡è®°é¢„è®¾æ ‡ç­¾é¡µï¼ˆå†å²èƒ½åŠ›ï¼ŒC7 å·²ä¸‹çº¿ï¼‰     âœ…
  - ç¼–è¾‘å™¨æ˜¾ç¤ºå¼•ç”¨æ­¤é¢„è®¾çš„ Action åˆ—è¡¨

D10. é…ç½®çª—å£ä¸ç¼“å­˜çƒ­åˆ·æ–°ä¼˜åŒ–ï¼ˆå†å²èƒ½åŠ›ï¼ŒC7 å·²ä¸‹çº¿ï¼‰             âœ…
  - ConfigurationWindowï¼ˆå†å²ï¼‰è®¢é˜… projectChangedï¼Œèµ„äº§å˜åŒ–æ—¶è‡ªåŠ¨åˆ·æ–°
  - æ ‡è®°é¢„è®¾å¼•ç”¨åˆ—è¡¨æ”¯æŒ C# + SO ä¸¤ç±» Actionï¼Œé¿å…ç©ºå¼•ç”¨
  - MarkerPresetRegistry / GizmoStyleConstants æ¥å…¥è‡ªåŠ¨å¤±æ•ˆ
```

---

## 10. å¼€æ”¾é—®é¢˜

| é—®é¢˜ | çŠ¶æ€ | å¤‡é€‰æ–¹æ¡ˆ |
|------|------|----------|
| æ¨¡æ¿ç¼©ç•¥å›¾å¦‚ä½•ç”Ÿæˆï¼Ÿ | å¾…å®š | A) è‡ªåŠ¨æˆªå›¾å­è“å›¾åŒºåŸŸ B) æ‰‹åŠ¨æŒ‡å®š C) ä½¿ç”¨åˆ†ç±»å›¾æ ‡ |
| SO æ¨¡æ¿æ˜¯å¦æ”¯æŒã€Œçƒ­åˆ·æ–°ã€ï¼Ÿ | è¿›è¡Œä¸­ | MarkerPresetRegistry / GizmoStyle ç¼“å­˜å·²æ¥å…¥ projectChanged è‡ªåŠ¨å¤±æ•ˆï¼›Action æ¨¡æ¿å…¨é“¾è·¯çƒ­åˆ·æ–°å¾…ç»Ÿä¸€ |
| MarkerPresetSO çš„ GizmoColor å¦‚ä½•ä¸å›¾å±‚ç³»ç»Ÿåè°ƒï¼Ÿ | å·²ç¡®è®¤ | ä¼˜å…ˆçº§ï¼šMarker è‡ªå®šä¹‰è‰²ï¼ˆå«é¢„è®¾å†™å…¥ï¼‰ > å›¾å±‚é¢œè‰² > é»˜è®¤é¢œè‰² |
| é…ç½®çª—å£æ˜¯å¦éœ€è¦æ”¯æŒæ‹–æ‹½æ’åºï¼Ÿ | å¾…å®š | å½“å‰æŒ‰åˆ†ç±»+åç§°è‡ªåŠ¨æ’åºï¼Œæš‚ä¸éœ€è¦æ‰‹åŠ¨æ’åº |
